{% extends "base.html" %}

{% block content %}
<!-- Fixed Header -->
<div class="page-header">
    <div class="header-left">
        <input type="text" id="searchInput" class="header-search" placeholder="Search by name...">
        <select id="categoryFilter" class="header-category">
            <option value="">All Categories</option>
            {% for cat in categories %}
            <option value="{{ cat }}">{{ cat.title() }}</option>
            {% endfor %}
        </select>
        <button id="addButton" class="btn-add">+ ADD</button>
    </div>
    <div class="header-right">
        <div class="header-logo">LOGO</div>
    </div>
    <button id="darkModeToggle" class="dark-mode-toggle" title="Toggle dark mode">
        <span class="dark-mode-icon">ðŸŒ™</span>
    </button>
</div>

<!-- Main Content Area -->
<div class="content-wrapper" id="contentWrapper">
    <!-- Items Grid -->
    <div class="items-grid-container" id="itemsGridContainer">
        <div id="itemsGrid" class="items-grid">
            <!-- Items will be loaded here -->
        </div>
    </div>

    <!-- Builder Toggle Button -->
    <div class="builder-toggle" id="builderToggle">
        <span class="toggle-arrow">â—€</span>
    </div>

   <!-- Builder Panel -->
    <div class="builder-panel" id="builderPanel">
        <div class="builder-content">
            <!-- Drop Overlay -->
            <div class="builder-drop-overlay" id="builderDropOverlay">
                <div class="builder-drop-icon">+</div>
            </div>

            <!-- Builder Layout -->
            <div class="builder-layout" id="builderLayout">
                <!-- Left Column -->
                <div class="builder-left">
                    <!-- Top/Outerwear Zone -->
                    <div class="builder-zone zone-top" id="zoneTop" data-category="top,outerwear">
                    </div>
                    <!-- Bottom Zone -->
                    <div class="builder-zone zone-bottom" id="zoneBottom" data-category="bottom">
                    </div>
                </div>

                <!-- Right Column -->
                <div class="builder-right">
                    <!-- Flexible Zone (Hat/Accessories/Other) -->
                    <div class="builder-zone zone-flexible" id="zoneFlexible" data-category="hat,accessory,other">
                    </div>
                    <!-- Shoes Zone -->
                    <div class="builder-zone zone-shoes" id="zoneShoes" data-category="shoes">
                    </div>
                </div>
            </div>

            <!-- Builder Actions -->
            <div class="builder-actions">
                <button id="randomizeOutfitBtn" class="btn-secondary" title="Randomize outfit">
                    ðŸ”€
                </button>
                <button id="exportOutfitBtn" class="btn-primary">Export as Image</button>
            </div>
        </div>
    </div>
</div>

<!-- Add Item Modal -->
<div id="addModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add New Item</h2>
            <span class="modal-close" id="addModalClose">&times;</span>
        </div>
        
        <form id="uploadForm" enctype="multipart/form-data">
            <div class="form-group">
                <label for="file">Select Image:</label>
                <input type="file" id="file" name="file" accept="image/*" required>
                <small>Supported formats: PNG, JPG, JPEG, WEBP (Max 16MB)</small>
            </div>

            <div class="form-group">
                <label for="name">Name (optional):</label>
                <input type="text" id="name" name="name" placeholder="e.g., Blue Denim Jacket">
            </div>

            <div class="form-group">
                <label for="category">Category (optional):</label>
                <select id="category" name="category">
                    <option value="">-- Select Category --</option>
                    {% for cat in categories %}
                    <option value="{{ cat }}">{{ cat.title() }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="tags">Tags (optional):</label>
                <input type="text" id="tags" name="tags" placeholder="e.g., Nike, Summer, Casual">
                <small>Separate multiple tags with commas</small>
            </div>

            <div id="uploadProgress" class="progress-bar" style="display: none;">
                <div class="progress-fill"></div>
                <span class="progress-text">Processing...</span>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn-secondary" id="cancelAdd">Cancel</button>
                <button type="submit" class="btn-primary">Upload & Process</button>
            </div>
        </form>
    </div>
</div>

<!-- View Item Modal -->
<div id="viewModal" class="modal">
    <div class="modal-content view-modal-content">
        <span class="modal-close" id="viewModalClose">&times;</span>
        <img id="viewModalImage" src="" alt="Item view">
        <div id="viewModalInfo" class="view-modal-info">
            <h3 id="viewModalName"></h3>
            <span id="viewModalCategory" class="category"></span>
            <div id="viewModalTags" class="item-tags"></div>
        </div>
    </div>
</div>

<!-- Edit Item Modal -->
{% include 'edit_modal.html' %}

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
{% endblock %}